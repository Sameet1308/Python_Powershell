import boto3

def lambda_handler(event, context):
    # Replace these placeholders with your target account ID and role name
    TARGET_ACCOUNT_ID = "123456789012"
    TARGET_ROLE_NAME = "glue-data-catalog-access-role"

    # Create a boto3 Glue client session for the target account
    session = boto3.Session(role_arn=f"arn:aws:iam::{TARGET_ACCOUNT_ID}:role/{TARGET_ROLE_NAME}")
    glue_client = session.client("glue")

    # Use a paginator to retrieve all tables in batches
    paginator = glue_client.get_paginator("list_tables")
    tables = []
    for page in paginator.paginate():
        tables.extend(page["TableList"])

    return {"tables": tables}

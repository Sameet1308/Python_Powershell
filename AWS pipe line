import boto3
import json

def copy_table_to_central(local_glue_client, central_glue_client, local_database_name, central_database_name, table_name):
    # Fetch table details from local Glue catalog
    table = local_glue_client.get_table(DatabaseName=local_database_name, Name=table_name)['Table']
    
    # Prepare the table input for the central Glue catalog
    table_input = {
        'Name': table['Name'],
        'Description': table.get('Description', ''),
        'StorageDescriptor': table['StorageDescriptor'],
        'PartitionKeys': table.get('PartitionKeys', []),
        'TableType': table['TableType'],
        'Parameters': table.get('Parameters', {})
    }
    
    # Create the table in the central Glue catalog
    central_glue_client.create_table(DatabaseName=central_database_name, TableInput=table_input)

def handler(event, context):
    # Local and central database names (replace with your actual database names)
    local_database_name = 'your_local_database'  # Replace with your local database name
    central_database_name = 'your_central_database'  # Replace with your central database name
    
    # Initialize the Glue clients
    local_glue_client = boto3.client('glue')
    central_glue_client = boto3.client('glue')
    
    # List tables in the local database
    tables = local_glue_client.get_tables(DatabaseName=local_database_name)['TableList']
    
    # Copy each table to the central Glue catalog
    for table in tables:
        table_name = table['Name']
        copy_table_to_central(local_glue_client, central_glue_client, local_database_name, central_database_name, table_name)
    
    return {
        'statusCode': 200,
        'body': json.dumps('Tables copied successfully!')
    }
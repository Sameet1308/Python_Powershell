from mstrio.connection import Connection
from mstrio.distribution_services import Document
import json

# MicroStrategy connection details
base_url = 'http://your-microstrategy-server.com/MicroStrategyLibrary/api'
username = 'your_username'
password = 'your_password'
project_name = 'your_project_name'

# Dashboard ID
dashboard_id = 'your_dashboard_id'

# Establish connection to MicroStrategy
conn = Connection(base_url, username, password, project_name=project_name, login_mode=1)
conn.connect()

# Function to get dashboard details
def get_dashboard_details(dashboard_id):
    dashboard = Document(connection=conn, id=dashboard_id)
    dashboard_info = dashboard.to_dict()
    return dashboard_info

# Fetch and print dashboard details
try:
    dashboard_details = get_dashboard_details(dashboard_id)
    print(json.dumps(dashboard_details, indent=4))
except Exception as e:
    print(f"Error: {e}")
finally:
    conn.close()

if sql_view:
    matches = re.findall(pattern, sql_view, flags=re.DOTALL | re.IGNORECASE)
    for match in matches:
        match=" ".join(match.split())
        parser = Parser(match)
        
        # Here, we'll add a try-except block to handle errors that may come from parser.tables or parser.columns
        try:
            for table in parser.tables:
                if not table.startswith(("ZZ","*")):
                    #print(f"\"{cube_id}\",\"{cube_name}\",\"{table}\"")
                    tables_list.append([PROJECT_NAME,cube_id,cube_name,cube_supbtype,table])
        except IndexError as e:
            print(f"An error occurred while parsing tables for cube {cube_name} {cube_id}: {e}")

        try:
            for column in parser.columns:
                if not column.startswith(("ZZ","*")):
                    #print(f"\"{cube_id}\",\"{cube_name}\",\"{column}\"")
                    columns_list.append([PROJECT_NAME,cube_id,cube_name,cube_supbtype,column])
        except IndexError as e:
            print(f"An error occurred while parsing columns for cube {cube_name} {cube_id}: {e}")
